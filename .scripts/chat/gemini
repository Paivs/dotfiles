#!/bin/bash

# Carregar vari√°vel de ambiente do .env
source /home/paiva/.scripts/chat/.env

MODEL="gemini-2.0-flash"
ENDPOINT="https://generativelanguage.googleapis.com/v1beta/models/$MODEL:generateContent?key=$GEMINI_API_KEY"

echo "üåü Gemini CLI - Modelo: $MODEL (Ctrl+C para sair)"
echo

while true; do
  echo -n "Voc√™: "
  read prompt

  if [[ -z "$prompt" ]]; then
    echo "‚ö†Ô∏è Prompt vazio. Tente novamente."
    continue
  fi

  # Realiza a requisi√ß√£o
  resposta=$(curl -s "$ENDPOINT" \
    -H "Content-Type: application/json" \
    -X POST \
    -d "{\"contents\":[{\"parts\":[{\"text\":\"$prompt\"}]}]}")

  # Usar o jq para pegar o texto da resposta
  output=$(echo "$resposta" | jq -r '.candidates[0].content.parts[0].text')

  if [[ -z "$output" ]]; then
    echo "‚ö†Ô∏è Erro na resposta: $resposta"
  else
    echo -e "\nü§ñ Gemini:\n$output" | glow -
  fi
  echo
done

